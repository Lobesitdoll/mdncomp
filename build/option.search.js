const utils=loadModule("core.utils");function doSearch(t){const e=utils.loadMDN(),o=utils.getComparer(t,options.fuzzy,!options.caseSensitive),s=[];return utils.getRootList(e).forEach(t=>(function t(n,r,i){const l=n[r];if("object"==typeof l){let n=Object.keys(l);options.deep||(n=n.filter(t=>"__compat"!==t)),n.filter(t=>{const o=utils.getPathAsObject(e,i+"."+t);return!(!options.deep&&o&&o.__compat&&o.__compat.title)||i.startsWith("css.")}).forEach(e=>{if("__compat"!==e||s.includes(i)){const n=i+"."+e;o.test(n)&&(e!==r&&s.length||!s.length)?s.push(n):t(l,e,n)}else{const t=l[e];("string"==typeof t.description&&o.test(t.description)||"string"==typeof(t.title||t.short)&&o.test(t.title||t.short)||function(t){for(let e of Object.keys(t)){const s=t[e],n=Array.isArray(s)?s:[s];for(let t of n){const e=t.notes;if("string"==typeof e&&o.test(e))return!0;if(Array.isArray(e))for(let t of e)if(o.test(t))return!0;if("string"==typeof t.alternative_name&&o.test(t.alternative_name))return!0;if("string"==typeof t.prefix&&o.test(t.prefix))return!0;if(Array.isArray(t.flags))for(let e of t.flags)if("string"==typeof e.type&&o.test(e.type)||"string"==typeof e.name&&o.test(e.name))return!0}}return!1}(t.support))&&s.push(i)}})}})(e,t,t)),s}function search(t=!1){const e=options.args.shift(),o=doSearch(e);if(o.length||t)if(o.length>1&&options.index<0){let t=Math.log10(o.length)+1,e="";o.forEach((o,s)=>{e+=`?y[?g${(""+s).padStart(t)}?y] ?w${o}\n`}),e+="?R\n"+utils.breakAnsiLine(text.addOptionIndex,options.maxLength),log(e)}else o.length>1&&options.index>=o.length?err(`?y${text.indexOutOfRange}.?R`):results(1===o.length?o[0]:o[options.index]);else options.fuzzy||options.deep||e.includes("*")||e.startsWith("/")?log(`?R${text.noResult}.`):(options.fuzzy=!0,options.args.unshift(e),search(!0))}function results(t){const e=loadModule("formatter.common")(t);e&&(loadModule(options.shorthand?"formatter.short":"formatter.long")(e),options.nofooter||log(`?p${text.dataFromMDN} - "npm i -g mdncomp" (c) epistemex?w?R${lf}`))}module.exports={search:search,results:results};