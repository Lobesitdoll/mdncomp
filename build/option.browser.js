const utils=require("./core.utils"),mdn=utils.loadMDN(),table=loadModule("core.table"),tblOptions={alignDefault:"l",delimiter:"  ",header:!1,start:"?w",end:"?R",stringLength:utils.ansiLength};function browsers(e){let t="boolean"==typeof e?".":e;"."===t?(log(`?R${text.valid} ${text.browserIds}:`),log(`?g${browserKeys().join(lf)}?R`),log(lf+`${text.valid} ${text.statuses}:`),log(ANSI.green+getBrowserStatusList().join(", "))):log(listBrowsers(t.toLowerCase()))}function browserKeys(){return Object.keys(mdn.browsers)}function listBrowsers(e){const t=mdn.browsers[e],s=[];if(!t)return getBrowserStatusList().includes(e)?listBrowserOnStatus(e):[`${text.unknownBrowser}: "${e}" - ${text.noArgListsId}.`];let r=0;return Object.keys(t.releases).forEach(e=>{let t=e.split(".");t[0].length>r&&(r=t[0].length)}),Object.keys(t.releases).sort(function(e,t){const s=e.split("."),r=t.split("."),o=(0|s[0])+.001*(0|s[1])+1e-6*(0|s[2])+1e-9*(0|s[3]),n=(0|r[0])+.001*(0|r[1])+1e-6*(0|r[2])+1e-9*(0|r[3]);return o>n?1:o<n?-1:0}).forEach(o=>{const n=t.releases[o],l=n.release_date||"-",a=n.release_notes||"",i=n.status;s.push([t.name||e,`?g${padVersion(o,r)}`,`?c${l}`,`${statusColor(i)}${i}`,`?R${options.notes?a:""}`])}),table(s,tblOptions)}function listBrowserOnStatus(e){const t=[],s=statusColor(e),r=iterateBrowsers((t,s,r,o,n)=>t.status&&t.status===e?{browser:n||s,version:r,notes:t.release_notes,date:t.release_date||"-"}:null);let o=0;return r.forEach(e=>{const t=e.version.split(".",1)[0]||"";o=Math.max(o,t.length)}),t.push([`?R${text.status.toUpperCase()}?R: ${s}${e.toUpperCase()}?R`]),r.forEach(e=>{t.push([`?w${e.browser}`,`${s}${padVersion(e.version,o)}`,`?c${e.date}`,`?R${options.notes&&e.notes?e.notes:""}`])}),table(t,tblOptions)}function getBrowserStatusList(){return iterateBrowsers((e,t,s,r)=>r.includes(e.status)?null:e.status).sort()}function statusColor(e){return{beta:"?y",current:"?g",esr:"?w",nightly:"?b",planned:"?m",retired:"?G"}[e]||"?R"}function iterateBrowsers(e){const t=mdn.browsers,s=[];return Object.keys(t).forEach(r=>{let o=t[r].name;Object.keys(t[r].releases).forEach(n=>{let l=e(t[r].releases[n],r,n,s,o);l&&s.push(l)})}),s}function padVersion(e,t){const s=e.split(".");return s[0].padStart(t)+s.join(".").substr(s[0].length)}module.exports=browsers;